因为基于用户的协同过滤 (User-Based CF)和基于物品的协同过滤 (Item-Based CF)，随着用户数量和物品数量的增长，用户-物品互动矩阵变得极度稀疏，计算量大，冷启动惩罚问题，本项目采用隐式反馈下的交替最小二乘法进行矩阵分解，以学习用户和商品的潜在特征。

1. 矩阵分解 (Matrix Factorization)
   
将高维、稀疏的用户-商品互动矩阵 R 分解为两个低秩的稠密矩阵：用户特征矩阵 U 和商品特征矩阵 V，使得：R ≈ U Vᵀ.

其中，U 是 M*K 矩阵，V 是 N*K 矩阵，K 是潜在因子（隐向量）的维度。

2. 隐式反馈与置信度 (Implicit Feedback & Confidence)

由于我们的数据是隐式反馈（互动次数，times），我们不能将缺失值简单视为负面反馈。通过遵循 Weighted Regularized Matrix Factorization 框架，引入 置信度 C{ui} 来加权损失函数, 置信度根据原始互动强度r{ui} 计算：

C{ui} = 1 + alpha * r{ui}

较高的 $\alpha$ 确保模型在拟合有互动的数据点时赋予更高的权重。

3.BM25 权重预处理

在模型训练之前，我们对原始的互动矩阵应用 BM25 权重, 用于调整原始的互动计数

·它惩罚与许多商品互动的用户（高活跃用户），从而突出其更独特的偏好。

·它奖励那些在不流行商品上有互动行为的用户。

如果一个用户互动了大量物品，那么他平均到每个物品 i 上的偏好强度（权重）就应该被稀释。

